# Day 3

## Info - Openshift S2I 
<pre>
- Unlike Kubernetes, Openshift apart from deploying application from readily available or pre-built custom docker image, one could deploy application from source code from your version control
- S2I stands for Source to Image, i.e Openshift will build the custom image based on your application source code
- Openshift S2I supports many different strategies
  1. Docker
  2. Source
  3. Custom
  4. Pipeline(Jenkins/TekTon)
  5. Binary(S2I Binary)
</pre>

## Info - Openshift S2I Docker Strategy
<pre>
- You will have to provide your Version control url, for example - https://github.com/tektutor/spring-ms.git
- The GitHub url should have your application source code and Dockerfile
- BuildConfig will be autogenerated by Openshift
- Application will be build to create application binary, using your application binary it will create a custom image as per your instructions in the Dockerfile
- the custom image built will then be pushed into Openshift Internal Image Registry
- It will then deploy your application using the image it pushed into Openshift Internal Image Registry
- It will automatically create BuildConfig and ImageStream, Deployment and Service
- You need to expose the source to creeate a route ( a public url to access the application )
  oc expose svc/hello
- You can then access the application using the route url from command-line or from the web console
</pre>

## Info - Openshift S2I Docker Strategy
<pre>
- You will have to provide your Version control url, for example - https://github.com/tektutor/spring-ms.git
- The GitHub url must have just the source code, Dockerfile is not required even if is there it will be ignored in the source strategy
- BuildConfig will be autogenerated by Openshift
- Application will be build to create application binary, using your application binary it will create a custom image as per the autogenerated Dockerfile instructions
- the custom image built will then be pushed into Openshift Internal Image Registry
- It will then deploy your application using the image it pushed into Openshift Internal Image Registry
- It will automatically create BuildConfig and ImageStream, Deployment and Service
- You need to expose the source to creeate a route ( a public url to access the application )
  oc expose svc/hello
- You can then access the application using the route url from command-line or from the web console
</pre>


## Lab - Deploying the application using S2I docker strategy
```
oc delete project jegan
oc new-project jegan

oc new-app --name=hello https://github.com/tektutor/spring-ms.git --strategy=docker
oc expose svc/hello

oc logs -f bc/hello
```
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/ec5f1fed-12f4-4e65-b36b-a522e563052c" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/3215ca29-c395-481a-a283-63c1ce78c402" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/f106bf48-5580-411b-af37-88fd93ec9a56" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/387dd5a5-062b-4af8-a83d-45b8441a9350" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/a811d3fd-8f72-422a-a97a-1bda255502d8" />

## Lab - Deploying the application using S2I source strategy
```
oc delete project jegan
oc new-project jegan

oc new-app --name=hello registry.access.redhat.com/ubi8/openjdk-17~https://github.com/tektutor/spring-ms.git --strategy=source
oc expose svc/hello

oc logs -f bc/hello
oc get routes

curl http://hello-jegan.apps.ocp4.palmeto.org
```
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/54e6b8e1-eca9-462c-b38a-42636bb1aad1" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/5eb16938-97a0-4259-b35c-22ea360a271e" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/fb98c084-a059-472e-ad5c-ef027aa9edf8" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/c65886c8-e04a-45e3-9f2d-ae4c35db16b4" />
<img width="1920" height="1168" alt="image" src="https://github.com/user-attachments/assets/e7ebb893-e846-4f5f-bf4d-9c2f14e5f3be" />

Try to understand buildconfig
```
oc project jegan
oc get buildconfigs
oc get builds
oc describe buildconfigs/hello
oc describe build/hello-1

oc edit bc/hello
```
